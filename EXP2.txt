SELECT B.BOOK_ID,LP.PROGRAMME_ID,B.TITLE,B.PUBLISHER_NAME,BC.NO_OF_COPIES,A.AUTHOR_NAME
FROM BOOK B, BOOK_AUTHORS A,BOOK_COPIES BC,LIBRARY_PROGRAMME LP
WHERE B.BOOK_ID=A.BOOK_ID AND B.BOOK_ID=BC.BOOK_ID AND BC.PROGRAMME_ID=LP.PROGRAMME_ID;

OR

SELECT B.BOOK_ID,TITLE,PUBLISHER_NAME,AUTHOR_NAME,NO_OF_COPIES
FROM BOOK B,BOOK_AUTHORS A,BOOK_COPIES BC
WHERE B.BOOK_ID=BC.BOOK_ID AND B.BOOK_ID=A.BOOK_ID;





SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT
BETWEEN '01-JAN-2023' AND '30-JUN-2023'
GROUP BY CARD_NO
HAVING COUNT(*)>=3;



DELETE FROM BOOK WHERE BOOK_ID =&BID;





 UPDATE BOOK_LENDING SET DATE_OUT='01-JAN-2023' WHERE CARD_NO='FA102';


CREATE TABLE BOOK1(
BOOK_ID VARCHAR2(20) PRIMARY KEY,
TITLE VARCHAR2(40),
PUBLISHER_NAME VARCHAR2(20) REFERENCES PUBLISHER(NAME) ON DELETE CASCADE,
PUB_YEAR INT)
PARTITION BY RANGE (PUB_YEAR)
(PARTITION P1 VALUES LESS THAN(2001),
PARTITION P2 VALUES LESS THAN(2005),
PARTITION P3 VALUES LESS THAN(2010),
PARTITION P4 VALUES LESS THAN(MAXVALUE));


INSERT INTO BOOK1 VALUES('B101','DBMS','PEARSON',2017);
INSERT INTO BOOK1 VALUES('B102','AIML','TATAMCGRAW',2009);
INSERT INTO BOOK1 VALUES('B103','DCN','PEARSON',2017);
INSERT INTO BOOK1 VALUES('B104','ATC','OXFORD',2017);
INSERT INTO BOOK1 VALUES('B105','PYTHON','OREILLY',2014);
INSERT INTO BOOK1 VALUES('B106','HADOOP','PEARSON',2000);


SELECT * FROM BOOK1 PARTITION(P1);



CREATE VIEW AVAILABLE_BOOK
AS
SELECT B.BOOK_ID,B.TITLE,
SUM (BC.NO_OF_COPIES)-(SELECT COUNT(*) FROM BOOK_LENDING B1 
WHERE B1.BOOK_ID=B.BOOK_ID
GROUP BY B1.BOOK_ID) AS BOOKS_AVAILABLE 
FROM BOOK1 B,BOOK_COPIES BC
WHERE B.BOOK_ID = BC.BOOK_ID
GROUP BY B.BOOK_ID,B.TITLE;
